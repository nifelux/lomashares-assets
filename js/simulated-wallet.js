const USER_NAME = document.getElementById("userData").dataset.name;const WALLET_KEY = "lomashares_wallet_" + USER_NAME;function getWallet() { return JSON.parse(localStorage.getItem(WALLET_KEY)) || { approvedBalance: 0, pendingBalance: 0, transactions: [] };}function saveWallet(w) { localStorage.setItem(WALLET_KEY, JSON.stringify(w)); render();}function render() { let w = getWallet(); document.getElementById("approvedBalance").innerText = w.approvedBalance.toLocaleString(); document.getElementById("pendingBalance").innerText = w.pendingBalance.toLocaleString(); document.getElementById("withdrawBtn").disabled = w.approvedBalance < 1000; let html = ""; w.transactions.forEach(tx => { html += &grave; <div class="tx"> <b>${tx.type}</b> ₦${tx.amount.toLocaleString()}<br> <small>${tx.id}</small><br> <span class="status ${tx.status.toLowerCase()}">${tx.status}</span> </div> &grave;; }); document.getElementById("txList").innerHTML = html || "<p>No transactions</p>";}function pay() { let amount = Number(document.getElementById("depositAmount").value); if (amount < 100) return alert("Minimum deposit ₦100"); let ref = "LS-" + Date.now(); PaystackPop.setup({ key: "pk_test_xxxxxxxxxxxxxx", email: USER_EMAIL, amount: amount * 100, currency: "NGN", ref: ref, callback: function () { let w = getWallet(); w.pendingBalance += amount; w.transactions.unshift({ id: ref, type: "Deposit", amount: amount, status: "Pending", date: new Date().toISOString() }); saveWallet(w); alert("Deposit submitted. Awaiting admin approval."); } }).openIframe();}function requestWithdraw() { let w = getWallet(); let amount = prompt("Enter withdrawal amount (₦)"); amount = Number(amount); if (amount < 1000) return alert("Minimum withdrawal ₦1,000"); if (amount > w.approvedBalance) return alert("Insufficient balance"); w.approvedBalance -= amount; w.transactions.unshift({ id: "WD-" + Date.now(), type: "Withdrawal", amount: amount, status: "Pending", date: new Date().toISOString() }); saveWallet(w); alert("Withdrawal request submitted");}render();
